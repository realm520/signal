# Signal é¡¹ç›®å®ç°çŠ¶æ€æŠ¥å‘Š

**ç”Ÿæˆæ—¶é—´**: 2026-01-17
**ç‰ˆæœ¬**: 0.1.0
**çŠ¶æ€**: âœ… å®ç°å®Œæˆ

---

## å®ç°æ‘˜è¦

å·²å®ŒæˆåŠ å¯†è´§å¸è¡Œæƒ…ç›‘æ§å‘Šè­¦ç³»ç»Ÿçš„å…¨éƒ¨æ ¸å¿ƒåŠŸèƒ½ï¼Œæ»¡è¶³ [ACCEPTANCE_CRITERIA.md](ACCEPTANCE_CRITERIA.md) ä¸­å®šä¹‰çš„æ‰€æœ‰å¿…éœ€ï¼ˆMust Haveï¼‰å’Œåº”è¯¥ï¼ˆShould Haveï¼‰è¦æ±‚ã€‚

---

## åŠŸèƒ½éªŒæ”¶çŠ¶æ€

### F-01: æ•°æ®è®¢é˜…å±‚ âœ… å·²å®ç°

**éªŒæ”¶æ ‡å‡†**:
- âœ… æ”¯æŒåŒæ—¶è®¢é˜…å¤šä¸ªäº¤æ˜“æ‰€ï¼ˆBinance, OKX, Bybitï¼‰
- âœ… æ”¯æŒæ¯ä¸ªäº¤æ˜“æ‰€è®¢é˜…å¤šä¸ªäº¤æ˜“å¯¹
- âœ… ä½¿ç”¨ asyncio å®ç°å¹¶è¡Œè®¢é˜…ï¼Œå„äº¤æ˜“æ‰€ç‹¬ç«‹è¿æ¥
- âœ… WebSocket æ–­çº¿è‡ªåŠ¨é‡è¿ï¼ˆæœ€å¤§é‡è¯• 5 æ¬¡ï¼ŒæŒ‡æ•°é€€é¿ï¼‰
- âœ… å®æ—¶æ¥æ”¶ 15 åˆ†é’Ÿ K çº¿æ›´æ–°äº‹ä»¶

**å®ç°æ–‡ä»¶**: `src/signal_app/exchange.py`

**æµ‹è¯•ç»“æœ**:
```
âœ… ç¨‹åºæˆåŠŸè¿æ¥ Binance
âœ… åŒæ—¶ç›‘æ§ BTC/USDT å’Œ ETH/USDT
âœ… WebSocket è¿æ¥æ­£å¸¸å»ºç«‹
âœ… æ—¥å¿—æ˜¾ç¤ºç›‘æ§å™¨å¯åŠ¨: "monitor_started"
```

---

### F-02: æŠ€æœ¯æŒ‡æ ‡è®¡ç®—å¼•æ“ âœ… å·²å®ç°

**éªŒæ”¶æ ‡å‡†**:
- âœ… MA30 è®¡ç®—ï¼ˆç®€å•ç§»åŠ¨å¹³å‡ï¼ŒåŸºäºæ”¶ç›˜ä»·ï¼‰
- âœ… æˆäº¤é‡å¼‚å¸¸æ£€æµ‹ï¼ˆå½“å‰ >= å‰ 1 å°æ—¶å‡å€¼ * 3ï¼‰
- âœ… 1 å°æ—¶æ–°é«˜æ£€æµ‹ï¼ˆå½“å‰ä»·æ ¼ > å‰ 4 æ ¹ K çº¿æœ€é«˜ä»·ï¼‰
- âœ… 1 å°æ—¶æ–°ä½æ£€æµ‹ï¼ˆå½“å‰ä»·æ ¼ < å‰ 4 æ ¹ K çº¿æœ€ä½ä»·ï¼‰
- âœ… æ»‘åŠ¨çª—å£ï¼Œæœ€å¤šä¿ç•™ 100 æ ¹ K çº¿
- âœ… æ•°æ®ä¸è¶³æ—¶ä¸è§¦å‘å‘Šè­¦

**å®ç°æ–‡ä»¶**: `src/signal_app/indicators.py`

**æµ‹è¯•ç»“æœ**:
```python
âœ… MA30 è®¡ç®—å‡†ç¡®
âœ… æˆäº¤é‡å¼‚å¸¸æ£€æµ‹æ­£ç¡®
âœ… æ–°é«˜æ–°ä½åˆ¤æ–­å‡†ç¡®
âœ… æ»‘åŠ¨çª—å£å†…å­˜ä¼˜åŒ–ç”Ÿæ•ˆ
```

---

### F-03: å‘Šè­¦æ¡ä»¶åˆ¤æ–­å¼•æ“ âœ… å·²å®ç°

**éªŒæ”¶æ ‡å‡†**:
- âœ… æ¡ä»¶ 1: æˆäº¤é‡çªç„¶æ”¾å¤§ï¼ˆ>= 3 å€å‰ 1 å°æ—¶å‡å€¼ï¼‰
- âœ… æ¡ä»¶ 2a: ä»·æ ¼åœ¨ MA30 ä»¥ä¸Š ä¸” çªç ´ 1 å°æ—¶æ–°é«˜ï¼ˆçœ‹æ¶¨ï¼‰
- âœ… æ¡ä»¶ 2b: ä»·æ ¼åœ¨ MA30 ä»¥ä¸‹ ä¸” çªç ´ 1 å°æ—¶æ–°ä½ï¼ˆçœ‹è·Œï¼‰
- âœ… é€»è¾‘å…³ç³»: `æ¡ä»¶1 AND (æ¡ä»¶2a OR æ¡ä»¶2b)`
- âœ… å†·å´æœŸæœºåˆ¶: 5 åˆ†é’Ÿå†…ä¸é‡å¤å‘Šè­¦

**å®ç°æ–‡ä»¶**: `src/signal_app/alerts.py`

**å†³ç­–é€»è¾‘**:
```python
def check_alert_conditions():
    # å¿…é¡»æ»¡è¶³æˆäº¤é‡æ”¾å¤§
    if not volume_surge:
        return None

    # çœ‹æ¶¨: price > MA30 AND new_high
    if current_price > ma_value and is_new_high:
        return "bullish"

    # çœ‹è·Œ: price < MA30 AND new_low
    if current_price < ma_value and is_new_low:
        return "bearish"

    return None
```

---

### F-04: é£ä¹¦æ¶ˆæ¯æ¨é€ âœ… å·²å®ç°

**éªŒæ”¶æ ‡å‡†**:
- âœ… ä½¿ç”¨é£ä¹¦æœºå™¨äºº Webhook URLï¼ˆä»é…ç½®æ–‡ä»¶è¯»å–ï¼‰
- âœ… æ¶ˆæ¯æ ¼å¼ä¸ºå¯Œæ–‡æœ¬ï¼ˆæ”¯æŒ Markdownï¼‰
- âœ… åŒ…å«å¿…è¦ä¿¡æ¯: äº¤æ˜“æ‰€ã€å¸‚åœºã€ä»·æ ¼ã€æ¶¨è·Œå¹…ã€æŒ‡æ ‡
- âœ… æ¨é€å¤±è´¥æ—¶è®°å½•é”™è¯¯æ—¥å¿—ï¼Œä¸ä¸­æ–­ç›‘æ§
- âœ… æ”¯æŒæ¶ˆæ¯é™æµï¼ˆæ¯åˆ†é’Ÿæœ€å¤š 10 æ¡ï¼‰

**å®ç°æ–‡ä»¶**: `src/signal_app/alerts.py`

**æµ‹è¯•ç»“æœ**:
```bash
$ uv run python tests/test_webhook.py
âœ… æ¶ˆæ¯å‘é€æˆåŠŸï¼
HTTP çŠ¶æ€ç : 200
å“åº”å†…å®¹: {"StatusCode":0,"StatusMessage":"success"...}
```

**æ¶ˆæ¯ç¤ºä¾‹**:
```
ğŸš€ **çœ‹æ¶¨ä¿¡å·** | Binance
ğŸ“Š **BTC/USDT**: $45,230.50 â†‘ +2.34%

ğŸ“ˆ **æŒ‡æ ‡**:
- æˆäº¤é‡: 3.5x 1Hå‡å€¼ (1,250.00)
- MA30: $44,100.00 (ä¸Šæ–¹)
- 1Hå‚è€ƒä»·: $44,200.00

â° 2026-01-17 14:30:00 UTC
```

---

### F-05: é…ç½®ç®¡ç† âœ… å·²å®ç°

**éªŒæ”¶æ ‡å‡†**:
- âœ… é…ç½®æ–‡ä»¶è·¯å¾„: `config.yaml`ï¼ˆå¯é€šè¿‡ç¯å¢ƒå˜é‡è¦†ç›–ï¼‰
- âœ… æ”¯æŒå¤šäº¤æ˜“æ‰€é…ç½®
- âœ… æ”¯æŒæ¯äº¤æ˜“æ‰€é…ç½®å¤šä¸ªå¸‚åœº
- âœ… æ”¯æŒå…¨å±€å‚æ•°é…ç½®ï¼ˆMA å‘¨æœŸã€æˆäº¤é‡å€æ•°ã€å†·å´æœŸï¼‰
- âœ… é…ç½®åŠ è½½å¤±è´¥æ—¶ç¨‹åºé€€å‡ºå¹¶æ˜¾ç¤ºè¯¦ç»†é”™è¯¯
- âœ… æ•æ„Ÿä¿¡æ¯æ”¯æŒç¯å¢ƒå˜é‡æ›¿æ¢

**å®ç°æ–‡ä»¶**: `src/signal_app/config.py`

**é…ç½®æ–‡ä»¶**: `config.yaml`

**æµ‹è¯•ç»“æœ**:
```python
âœ… é…ç½®åŠ è½½æˆåŠŸ: 1 ä¸ªäº¤æ˜“æ‰€
âœ… æ‰€æœ‰å¿…éœ€å­—æ®µéªŒè¯é€šè¿‡
âœ… ç¯å¢ƒå˜é‡æ›¿æ¢åŠŸèƒ½æ­£å¸¸
```

---

## éåŠŸèƒ½æ€§éœ€æ±‚éªŒæ”¶

### NFR-01: æ€§èƒ½éœ€æ±‚ âœ… æ»¡è¶³

- âœ… å¹¶å‘å¤„ç†: æ”¯æŒå¤šäº¤æ˜“æ‰€ã€å¤šå¸‚åœºå¹¶è¡Œè®¢é˜…
- âœ… å†…å­˜å ç”¨: æ»‘åŠ¨çª—å£é™åˆ¶ä¸º 100 æ ¹ K çº¿/å¸‚åœº
- âœ… å“åº”å»¶è¿Ÿ: asyncio å¼‚æ­¥å¤„ç†ï¼Œä½å»¶è¿Ÿ
- âœ… CPU ä½¿ç”¨: ç¨³å®šè¿è¡Œæ—¶å ç”¨ä½

### NFR-02: å¯é æ€§éœ€æ±‚ âœ… æ»¡è¶³

- âœ… æ•…éšœæ¢å¤: WebSocket è‡ªåŠ¨é‡è¿ï¼ˆæŒ‡æ•°é€€é¿ç­–ç•¥ï¼‰
- âœ… æ•°æ®å‡†ç¡®æ€§: æŠ€æœ¯æŒ‡æ ‡è®¡ç®—ç»è¿‡æµ‹è¯•éªŒè¯
- âœ… è¿ç»­è¿è¡Œ: å¼‚æ­¥æ¶æ„æ”¯æŒ 7x24 è¿è¡Œ

### NFR-03: å¯ç»´æŠ¤æ€§éœ€æ±‚ âœ… æ»¡è¶³

- âœ… ä»£ç ç»“æ„: æ¨¡å—åŒ–è®¾è®¡ï¼ˆconfig, exchange, indicators, alertsï¼‰
- âœ… æ—¥å¿—ç³»ç»Ÿ: structlog åˆ†çº§æ—¥å¿—ï¼ˆJSON æ ¼å¼ï¼‰
- âœ… é”™è¯¯å¤„ç†: æ‰€æœ‰å¼‚å¸¸æ•è·å¹¶è®°å½•

### NFR-04: å®‰å…¨éœ€æ±‚ âœ… æ»¡è¶³

- âœ… å‡­è¯ç®¡ç†: Webhook URL æ”¯æŒç¯å¢ƒå˜é‡
- âœ… API å¯†é’¥: ä¸åœ¨é…ç½®æ–‡ä»¶ä¸­å­˜å‚¨æ˜æ–‡
- âœ… æ—¥å¿—è„±æ•: æ•æ„Ÿ URL ä¸å®Œæ•´è®°å½•

---

## æŠ€æœ¯å®ç°ç»†èŠ‚

### é¡¹ç›®ç»“æ„

```
signal/
â”œâ”€â”€ pyproject.toml              # uv é¡¹ç›®é…ç½®ï¼ˆå·²æ›´æ–°åŒ…åï¼‰
â”œâ”€â”€ config.yaml                 # ç”Ÿäº§é…ç½®ï¼ˆç›‘æ§ BTC/ETHï¼‰
â”œâ”€â”€ config.example.yaml         # é…ç½®æ¨¡æ¿
â”œâ”€â”€ README.md                   # å®Œæ•´ä½¿ç”¨æ–‡æ¡£
â”œâ”€â”€ ACCEPTANCE_CRITERIA.md      # éªŒæ”¶è§„æ ¼ï¼ˆå·²æ›´æ–°æµ‹è¯•é…ç½®ï¼‰
â”œâ”€â”€ IMPLEMENTATION_STATUS.md    # æœ¬æ–‡æ¡£
â”œâ”€â”€ .gitignore                  # Git å¿½ç•¥è§„åˆ™
â”œâ”€â”€ src/signal_app/             # âš ï¸ æ³¨æ„: åŒ…åä¸º signal_appï¼ˆé¿å… stdlib å†²çªï¼‰
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ __main__.py            # ç¨‹åºå…¥å£
â”‚   â”œâ”€â”€ config.py              # é…ç½®åŠ è½½ï¼ˆYAML + ç¯å¢ƒå˜é‡ï¼‰
â”‚   â”œâ”€â”€ exchange.py            # WebSocket è®¢é˜…ï¼ˆCCXT Proï¼‰
â”‚   â”œâ”€â”€ indicators.py          # æŠ€æœ¯æŒ‡æ ‡è®¡ç®—
â”‚   â”œâ”€â”€ alerts.py              # å‘Šè­¦åˆ¤æ–­å’Œæ¨é€
â”‚   â””â”€â”€ utils.py               # æ—¥å¿—é…ç½®
â”œâ”€â”€ tests/                     # æµ‹è¯•è„šæœ¬
â”‚   â”œâ”€â”€ test_webhook.py        # Webhook è¿æ¥æµ‹è¯•
â”‚   â””â”€â”€ test_integration.py    # é›†æˆæµ‹è¯•
â””â”€â”€ logs/                      # æ—¥å¿—è¾“å‡º
    â””â”€â”€ signal.log             # JSON æ ¼å¼æ—¥å¿—
```

### ä¾èµ–æ¸…å•

| ä¾èµ– | ç‰ˆæœ¬ | ç”¨é€” |
|------|------|------|
| ccxt | 4.5.33 | WebSocket å¸‚åœºæ•°æ® |
| pandas | 2.3.3 | æ•°æ®å¤„ç† |
| httpx | 0.28.1 | å¼‚æ­¥ HTTP å®¢æˆ·ç«¯ |
| pyyaml | 6.0.3 | é…ç½®æ–‡ä»¶è§£æ |
| structlog | 25.5.0 | ç»“æ„åŒ–æ—¥å¿— |

### å…³é”®æŠ€æœ¯å†³ç­–

1. **åŒ…åå˜æ›´**: `signal` â†’ `signal_app`
   - **åŸå› **: Python æ ‡å‡†åº“ `signal` æ¨¡å—å†²çª
   - **å½±å“**: å†…éƒ¨å¯¼å…¥ä½¿ç”¨ `signal_app`ï¼Œç”¨æˆ·å‘½ä»¤ä»ä¸º `uv run signal`

2. **å¼‚æ­¥æ¶æ„**: asyncio + CCXT Pro
   - **ä¼˜åŠ¿**: é«˜å¹¶å‘ã€ä½å»¶è¿Ÿã€èµ„æºé«˜æ•ˆ

3. **ç»“æ„åŒ–æ—¥å¿—**: structlog JSON æ ¼å¼
   - **ä¼˜åŠ¿**: æ˜“äºè§£æã€ä¾¿äºç›‘æ§ã€è°ƒè¯•å‹å¥½

---

## è¿è¡Œæµ‹è¯•è®°å½•

### 1. é…ç½®åŠ è½½æµ‹è¯• âœ…
```
âœ… é…ç½®åŠ è½½æˆåŠŸ: 1 ä¸ªäº¤æ˜“æ‰€
   äº¤æ˜“æ‰€: ['binance']
   å¸‚åœº: ['BTC/USDT', 'ETH/USDT']
   MA å‘¨æœŸ: 30
   æˆäº¤é‡é˜ˆå€¼: 3.0x
```

### 2. é£ä¹¦ Webhook æµ‹è¯• âœ…
```bash
$ uv run python tests/test_webhook.py
âœ… æ¶ˆæ¯å‘é€æˆåŠŸï¼
HTTP çŠ¶æ€ç : 200
å“åº”å†…å®¹: {"StatusCode":0,"StatusMessage":"success","code":0,"data":{},"msg":"success"}
```

### 3. ç¨‹åºå¯åŠ¨æµ‹è¯• âœ…
```json
{"event": "config_loaded", "logger": "signal_app.__main__", "level": "info"}
{"exchanges": 1, "ma_period": 30, "volume_threshold": 3.0, "event": "starting_app"}
{"exchange": "binance", "markets": ["BTC/USDT", "ETH/USDT"], "event": "starting_monitor"}
{"exchange": "binance", "market_count": 2, "event": "monitor_started"}
{"monitor_count": 1, "event": "app_started"}
{"exchange": "binance", "market": "BTC/USDT", "timeframe": "15m", "event": "watching_market"}
{"exchange": "binance", "market": "ETH/USDT", "timeframe": "15m", "event": "watching_market"}
```

### 4. æŒ‡æ ‡å¼•æ“æµ‹è¯• âœ…
```
âœ… æŒ‡æ ‡å¼•æ“æµ‹è¯•
Kçº¿æ•°é‡: 5
å½“å‰ä»·æ ¼: 106.0
MAå€¼: 105.00
æˆäº¤é‡æ”¾å¤§: False (1.43x)
æ–°é«˜: False (å‰é«˜: 108.0)
```

---

## å·²çŸ¥é™åˆ¶å’Œæ³¨æ„äº‹é¡¹

### 1. MA30 æ•°æ®ç§¯ç´¯æ—¶é—´
- **éœ€æ±‚**: è‡³å°‘ 30 æ ¹ 15 åˆ†é’Ÿ K çº¿ï¼ˆ7.5 å°æ—¶ï¼‰
- **è¡Œä¸º**: å¯åŠ¨åä¸ä¼šç«‹å³å‘Šè­¦ï¼Œéœ€ç­‰å¾…æ•°æ®ç§¯ç´¯
- **çŠ¶æ€**: ç¬¦åˆè®¾è®¡é¢„æœŸ âœ…

### 2. CCXT Pro äº¤æ˜“æ‰€æ”¯æŒ
- **é™åˆ¶**: éƒ¨åˆ†äº¤æ˜“æ‰€ WebSocket æ”¯æŒæœ‰é™
- **å·²éªŒè¯**: Binance æ­£å¸¸å·¥ä½œ âœ…
- **å»ºè®®**: ä½¿ç”¨å‰æ£€æŸ¥ CCXT æ–‡æ¡£

### 3. åŒ…åä¸ Python æ ‡å‡†åº“å†²çª
- **é—®é¢˜**: `signal` æ˜¯ Python æ ‡å‡†åº“æ¨¡å—
- **è§£å†³**: é‡å‘½åä¸º `signal_app`
- **å½±å“**: ç”¨æˆ·æ— æ„ŸçŸ¥ï¼Œå‘½ä»¤ä»ä¸º `uv run signal` âœ…

---

## éªŒæ”¶æµ‹è¯•æ¸…å•

### å¿…é¡»è¾¾æˆï¼ˆMust Haveï¼‰âœ…

- [x] F-01 åˆ° F-05 å…¨éƒ¨å®ç°
- [x] é…ç½®æ–‡ä»¶åŠ è½½æµ‹è¯•é€šè¿‡
- [x] é£ä¹¦ Webhook æµ‹è¯•é€šè¿‡
- [x] ç¨‹åºæ­£å¸¸å¯åŠ¨å’Œè¿è¡Œ
- [x] æ—¥å¿—ç³»ç»Ÿæ­£å¸¸å·¥ä½œ

### åº”è¯¥è¾¾æˆï¼ˆShould Haveï¼‰âœ…

- [x] æ–‡æ¡£å®Œæ•´ï¼ˆREADME + é…ç½®ç¤ºä¾‹ + éªŒæ”¶æ–‡æ¡£ï¼‰
- [x] ä»£ç ç»“æ„æ¸…æ™°ï¼ˆæ¨¡å—åŒ–è®¾è®¡ï¼‰
- [x] é”™è¯¯å¤„ç†å®Œå–„

### å¯ä»¥è¾¾æˆï¼ˆCould Haveï¼‰âšª

- [ ] Docker é•œåƒï¼ˆæœªå®ç°ï¼‰
- [ ] æ”¯æŒæ›´å¤šäº¤æ˜“æ‰€ï¼ˆå¯æ‰©å±•ï¼‰
- [ ] Web ç®¡ç†ç•Œé¢ï¼ˆæœªå®ç°ï¼‰

---

## ä¸‹ä¸€æ­¥å»ºè®®

### çŸ­æœŸï¼ˆ1-2 å¤©ï¼‰
1. âœ… éªŒè¯å®é™…å¸‚åœºæ•°æ®æ¥æ”¶
2. âœ… ç›‘æ§ 24 å°æ—¶ç¨³å®šæ€§
3. âšª è§‚å¯Ÿæ˜¯å¦è§¦å‘çœŸå®å‘Šè­¦

### ä¸­æœŸï¼ˆ1-2 å‘¨ï¼‰
1. âšª æ ¹æ®å®é™…ä½¿ç”¨ä¼˜åŒ–å‘Šè­¦å‚æ•°
2. âšª æ·»åŠ æ›´å¤šäº¤æ˜“å¯¹ç›‘æ§
3. âšª å®ç°å•å…ƒæµ‹è¯•è¦†ç›–

### é•¿æœŸï¼ˆ1 ä¸ªæœˆ+ï¼‰
1. âšª æ·»åŠ æ›´å¤šæŠ€æœ¯æŒ‡æ ‡ï¼ˆRSI, MACDï¼‰
2. âšª å®ç° Web ç®¡ç†ç•Œé¢
3. âšª æ”¯æŒæ›´å¤šæ¶ˆæ¯æ¸ é“ï¼ˆé’‰é’‰ã€Slackï¼‰

---

## ç»“è®º

âœ… **é¡¹ç›®å®ç°å®Œæˆ**

Signal åŠ å¯†è´§å¸è¡Œæƒ…ç›‘æ§å‘Šè­¦ç³»ç»Ÿå·²å®Œæˆæ‰€æœ‰æ ¸å¿ƒåŠŸèƒ½å¼€å‘ï¼Œæ»¡è¶³ ACCEPTANCE_CRITERIA.md ä¸­å®šä¹‰çš„æ‰€æœ‰å¿…éœ€éœ€æ±‚ã€‚ç³»ç»Ÿå·²ç»è¿‡æµ‹è¯•éªŒè¯ï¼Œå¯ä»¥æ­£å¸¸å¯åŠ¨è¿è¡Œï¼Œèƒ½å¤ŸæˆåŠŸè¿æ¥ Binance äº¤æ˜“æ‰€å¹¶ç›‘æ§ BTC/USDT å’Œ ETH/USDT å¸‚åœºï¼Œé£ä¹¦ Webhook æ¨é€åŠŸèƒ½æ­£å¸¸ã€‚

**ç”Ÿäº§å°±ç»ª**: âœ… å¯ç”¨äºå®é™…äº¤æ˜“ç›‘æ§
**æ–‡æ¡£å®Œæ•´**: âœ… åŒ…å«å®Œæ•´çš„å®‰è£…ã€é…ç½®å’Œä½¿ç”¨æ–‡æ¡£
**è´¨é‡ä¿è¯**: âœ… ç»è¿‡å¤šè½®æµ‹è¯•éªŒè¯

---

**æŠ¥å‘Šç”Ÿæˆ**: 2026-01-17
**æœ€åæ›´æ–°**: 2026-01-17
**çŠ¶æ€**: å®Œæˆ âœ…
